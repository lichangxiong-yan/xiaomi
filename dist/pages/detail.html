<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><title>Document</title><link rel=stylesheet href=../css/list.css><link rel=stylesheet href=../sass/detail.css></head><body><div id=head><div class=head-con><ul><li style=border-left:none><a href="">小米商城</a></li><li><a href="">MIUI</a></li><li><a href="">loT</a></li><li><a href="">云服务</a></li><li><a href="">金融</a></li><li><a href="">有品</a></li><li><a href="">小爱开放平台</a></li><li><a href="">企业团购</a></li><li><a href="">资质证照</a></li><li><a href="">协议规则</a></li><li><a href="">下载app</a></li><li style=border-right:none><a href="">Select Location</a></li></ul><div class=head-conr><ul><li style=border-left:none><a href="">登录</a></li><li><a href="">注册</a></li><li style="border-left:none;margin:0 9px"><a href="">消息通知</a></li></ul></div><div class=head-cong><a href=""><span>购物车&nbsp;（0）</span> <i style=border-top:none>购物车中还没有商品，赶紧选购吧!</i></a></div></div></div><div id=daohang><div class=dao-con><div class=dao-logo><a href=""><img src=../images/logo_03.jpg alt=""></a></div><ul class=dao-conu><li class=a><a href="">全部商品分类</a></li><div class=ban-con><ul class=kk><li>23423</li><li>234</li><li>23423</li><li>23423</li><li>2342</li><li>23423</li><li>2342</li><li>2342</li><li>2342</li><li></li></ul></div><div class=houmian><ul><li class=b><a href="">123</a></li></ul></div></ul><div class=dao-ss><input type=text name="" id="" value="" style="border-right:1px solid #ccc"> <a href=""><span class=dao-ss1>小米9 Pro 5G</span></a> <a href=""><span class=dao-ss2>Redmi Note8</span></a></div></div></div><div class=nav_box><ul class=container><li><div><img src="https://cdn.cnbj1.fds.api.mi-img.com/mi-mall/82ddffd7562c54f9166fa876c143ff22.png?thumb=1&w=200&h=138&f=webp&q=90" alt=""></div><p>小米手机</p><span>1999</span></li><li>2</li><li>3</li><li>4</li><li>5</li><li style=border:none>6</li></ul></div><div class=xxk><ul class=kk><li><h2><img src="https://cdn.cnbj1.fds.api.mi-img.com/mi-mall/d622e8a81f81caa0f619ee750cf64501.png?thumb=1&w=50&h=50&f=webp&q=90" alt=""></h2><h3>1</h3></li></ul></div><div class=xm-product-box><div class=container><h2>小米cc9pro</h2><div class=con><div class=left><span class=separator>|</span> <a href="">小米ccc9</a> <span>|</span> <a href="">小米ccc9美图定制版</a></div><div class=right><span class=separator>|</span> <a href="">概述</a> <span>|</span> <a href="">参数</a> <span class=separator>|</span> <a href="">F码通道</a> <span>|</span> <a href="">用户评价</a></div></div></div></div><div class=main><div class=main-left><img src=https://cdn.cnbj0.fds.api.mi-img.com/b2c-shopapi-pms/pms_1572941230.01013581.jpg alt=""></div><div class=main-right><h1 class=name>小米CC9 Pro</h1><p>「分期享6期免息，购机享1TB小米云空间1年使用权」1亿像素主摄 / 全场景五摄像头 / 四闪光灯 / 3200万自拍 / 10 倍混合光学变焦，50倍数字变焦 / 5260mAh ⼤电量 / 标配 30W疾速快充 / ⼩米⾸款超薄屏下指纹 / 德国莱茵低蓝光认证 / 多功能NFC / 红外万能遥控 / 1216超线性扬声器</p><h3>小米自营店</h3><h2 class=jiage>2699元</h2><div class=right-xiao><div><span>北京</span> <span>北京市</span> <span>东城区</span> <span>安定门街道</span> <span class=span1>修改</span></div></div><div class=list-wrap><div class=step-title>选择版本</div><ul><li><span>8GB+128GB</span> <span>2799元</span></li><li><span>8GB+128GB</span> <span>2799元</span></li><li><span>8GB+128GB</span> <span>2799元</span></li></ul><div class=step-yanse>选择颜色</div><ul class=ul><li><img src=https://cdn.cnbj0.fds.api.mi-img.com/b2c-shopapi-pms/pms_1572941094.42616676.jpg alt=""> <span>魔法绿镜</span></li><li><img src=https://cdn.cnbj0.fds.api.mi-img.com/b2c-shopapi-pms/pms_1572941094.42616676.jpg alt=""> <span>魔法绿镜</span></li><li><img src=https://cdn.cnbj0.fds.api.mi-img.com/b2c-shopapi-pms/pms_1572941094.42616676.jpg alt=""> <span>魔法绿镜</span></li></ul><div class=step-yanse>选择小米提供的意外保护</div><ul class=ul2><li class=li3><img src="https://cdn.cnbj0.fds.api.mi-img.com/b2c-shopapi-pms/pms_1572508606.45994169.png?width=50&height=50" alt=""><div><span class=name>意外保障服务</span><p class=desc>手机意外碎屏/进水/碾压损坏</p><p><em>√</em> "我已阅读" <a href="">服务条款</a> <span>|</span> <a href="">常见问题</a></p><span class=price>349元</span></div></li><li class=li4><img src="https://cdn.cnbj0.fds.api.mi-img.com/b2c-shopapi-pms/pms_1572508606.45994169.png?width=50&height=50" alt=""><div><span class=name>碎屏保障服务</span><p class=desc>手机意外碎屏/进水/碾压损坏</p><p><em>√</em> "我已阅读" <a href="">服务条款</a> <span>|</span> <a href="">常见问题</a></p><span class=price>249元</span></div></li></ul><div class=div4>选择小米提供意外延长保修</div><ul class=ul2><li class=li3><img src="https://cdn.cnbj0.fds.api.mi-img.com/b2c-shopapi-pms/pms_1572508606.45994169.png?width=50&height=50" alt=""><div><span class=name>意外保障服务</span><p class=desc>手机意外碎屏/进水/碾压损坏</p><p><em>√</em> "我已阅读" <a href="">服务条款</a> <span>|</span> <a href="">常见问题</a></p><span class=price>519元</span></div></li></ul><div class=div5>选择小米提供的云空间服务</div><ul class=ul5><li class=li5><img src="https://cdn.cnbj0.fds.api.mi-img.com/b2c-shopapi-pms/pms_1572508606.45994169.png?width=50&height=50" alt=""><div><span class=name>意外保障服务</span><p class=desc>手机意外碎屏/进水/碾压损坏</p><p><em>√</em> "我已阅读" <a href="">服务条款</a> <span>|</span> <a href="">常见问题</a></p><span class=price>519元</span></div></li><li class=li5><img src="https://cdn.cnbj0.fds.api.mi-img.com/b2c-shopapi-pms/pms_1572508606.45994169.png?width=50&height=50" alt=""><div><span class=name>意外保障服务</span><p class=desc>手机意外碎屏/进水/碾压损坏</p><p><em>√</em> "我已阅读" <a href="">服务条款</a> <span>|</span> <a href="">常见问题</a></p><span class=price>519元</span></div></li><li class=li5><img src="https://cdn.cnbj0.fds.api.mi-img.com/b2c-shopapi-pms/pms_1572508606.45994169.png?width=50&height=50" alt=""><div><span class=name>意外保障服务</span><p class=desc>手机意外碎屏/进水/碾压损坏</p><p><em>√</em> "我已阅读" <a href="">服务条款</a> <span>|</span> <a href="">常见问题</a></p><span class=price>519元</span></div></li><li class=li5><img src="https://cdn.cnbj0.fds.api.mi-img.com/b2c-shopapi-pms/pms_1572508606.45994169.png?width=50&height=50" alt=""><div><span class=name>意外保障服务</span><p class=desc>手机意外碎屏/进水/碾压损坏</p><p><em>√</em> "我已阅读" <a href="">服务条款</a> <span>|</span> <a href="">常见问题</a></p><span class=price>519元</span></div></li></ul></div></div></div><div id=pro-con><div id=pro-list><ul><li><a href="" class=xioami>小米CC9 Pro 8GB+128GB 魔法绿境</a> <del>3099</del> <span class=danjia>2799</span></li><li class=totlePrice>总计 ：2799元</li></ul></div></div><ul class=jiaru><li class=li1>加入购物车</li><li class=li2>喜欢</li></ul><script src=../lib/jquery/dist/jquery.min.js></script><script>// 选项卡

        getList2()

        function getList2() {


            $.ajax({
                url: '../lib/two.json',
                dataType: 'json',
                success: function (res) {
                    console.log(res)
                    let str = ''
                    res.forEach((value) => {
                        str +=
                            ` <li>${value.name}<em class="iconfont icon-arrow-right-copy-copy-copy"></em></li>`
                    })
                    $('.ban-con > ul').html(str)
                    $('.ban-con > ul').children('li').on({
                        mouseenter: function () {
                            const index1 = $(this).index()
                            const list1 = res[index1].list
                            let str1 = ""
                            list1.forEach((item) => {
                                str1 += `<li>
                                <h2>
                    <img src="${item.src}" alt=""></h2>
                    <h3>${item.title}</h3>
                </li>`
                            })
                            $('.xxk').show()
                            $('.xxk > ul').html(str1)


                        },
                        mouseleave: function () {

                            $('.xxk').hide()
                        }
                    })

                }
            })
        }
        $('.a').on({
            mouseenter: function () {
                $('.ban-con>ul').show()

            },
            //    mouseleave:function(){
            //     $('.ban-con>ul').hide()
            //    }
        })

        $('.ban-con>ul').on({
            mouseleave: function () {
                $('.ban-con>ul').hide()
            }
        })



        getList()

        function getList() {
            $.ajax({
                url: "../lib/nav_top.json",
                dataType: 'json',
                success: function (res) {
                    // console.log(res)

                    let str = '';
                    res.forEach(item => {
                        str += `<li><a>${item.name}</a></li>`
                    })


                    $('.houmian>ul').html(str)
                        .on({
                            mouseenter: () => $('.nav_box').stop().slideDown(),
                            mouseleave: () => $('.nav_box').stop().slideUp()
                        })
                        .children('li')
                        .on('mouseover', function () {
                            const index = $(this).index()
                            const list = res[index].list

                            let str = ''

                            list.forEach(item => {
                                str += `
                                    <li>
                                        <div>
                                                <img src="${ item.list_url }" alt=""> </div> 
                                                <p>${item.list_name}</p>
                                                <span>${item.list_price}</span>
                                                </li>
                                `
                            })
                            $('.nav_box > ul').html(str)
                        })
                    $('.nav_box')
                        .on({
                            mouseover: function () {
                                $(this).finish().show()
                            },
                            mouseout: function () {
                                $(this).finish().slideUp()

                            }
                        })

                }
            })
        }



        /*
      我是详情页面
        1. 从 localStorage 里面获取数据
    */

        // // 判断一下数据
        // if (goodsInfo === null) {
        //   alert('您查看的商品详情不存在了')
        // } else {
        //   alert('我要渲染页面, 内容就是 ' + goodsInfo.name)
        // }


        // 1.从 localStorage 里面拿到数据
        // 从详情页面跳转过来的时候拿过来的数据

        // 2.渲染页面
        // 要 localStorage 有没有数据
        // 因为有可能不是通过列表页跳转过来的
        // 如果没有数据，提示用户，跳转回list页面


        //3.使用数据渲染页面
        // 4.点击加入购物车
        // 4-1 给添加购物车按钮添加一个点击事件
        // 4-2.判断是否登入
            //   => 如果没有登入，将会弹出登入页面
                    //  ->如果你登入过，cookie 里面会友一个标识符来决定是否登入过
            // 如果登入过，直接应该就可以把渲染当前页面的这个商品直接假如购物车
         // 4—3加入到购物车数据(localStorage 模拟)
            // 在购物车页面须要一个数组来渲染
            // 有一个数组存储在 localStorage 里面
                    // ->我点击购物车的时候
                    // ->向这个数组里面存储
                // 如果是第一次点击添加购物车
                      // 这个时候 localStorage 里面还没有这个数组呢
                      // 我们就要创建一个数组，把数据放进去，存储在 localStorage里面
                // 后面的点击加入购物车
                       // localStorage 里面已经有一个数组了
                        // 直接拿到这个数组，向里面push 一个数据
                        // 再次存储进去就可以了
            // 4-4.加入购物车时候的判断
                    // =>再加入购物车的时候，判断一下，如果原先里面有这个数据了
                        // ->就不需要 push了
                        // 直接在数据的基础上数量 +1
                    // 再加入购物车的时候,判断一下，如果原先里面没有这个数据
                        // ->直接push 就可以了
                        // 因为本身数据里面没有数量信息
                            //  因为使我们模拟的购物车，所有没有
                                // 我们就手动给这个数据加上一个  number 的信息，表示购买



        // 1. 获取 localStorage 里面的数据
        const goodsInfo = JSON.parse(localStorage.getItem('goods_info'))

        // 2.判端数据是否存在
        if (!goodsInfo) {
            alert('你要查看的数据不存在')
            //跳转回list页面
            window.location.href = '.list.html'


        }
        // console.log(goodsInfo)

        // 3.渲染页面
        bindHtml()

        function bindHtml() {
            $('.main-left img').attr('src', goodsInfo.list_url)
            $('.main-right .name').text(goodsInfo.list_name)
            $('.xioami').text(goodsInfo.list_name)
            $('.main-right .jiage').text(goodsInfo.list_price)
            $('.danjia').text(goodsInfo.list_price)
            $('.totlePrice').text(goodsInfo.list_price)
        }

        // 4.点击加如购物车
        // 4-1
        $('.li1').click(()=>{
            console.log('我要添加购物车了')

            // 4-2判断是否登录

            // 4-3 加入到购物车数组里面
                //  先拿到 localStorage 里面的那个数组信息
                // 如果原先没有数据，那么我就用一个空数组来代替
                // 如果有数据，就用我们的数据
            const cartList=JSON.parse(localStorage.getItem('cartList'))||[]
            
            // 向数组里面吧这本条数据添加进去
            
          
            // 4-4 判断有没有这个数据
                    // 每一个数据都有一个自己的id
                    // 只要看数组里面有没有id一样的数据，就知道有没有这个数据
                    // 数组常用方法有个叫做 some 的方法  
                    // 返回值：
                            // true:表示数组里面有这个信息
                            // false:表示数组里面没有这个信息
                    let exits =cartList.some(item=>{
                        // 数据里面每一个的id===本页面的这条数据的id
                        return item.id===goodsInfo.id
                    })

                      console.log(exits)
                      if(exits){
                          console.log('已经存在 number++')
                        //   找到这个信息 number++
                          let data=null;
                           for(let i=0;i<cartList.length;i++){
                               if(cartList[i].id===goodsInfo.id){
                                   cartList[i].number++;
                                   break;
                               }
                           }
                        //    data 就是我找到这个信息

                      }else{
                        //   表示没有这个信息，直接 push 就可以了
                        // push 之前，向里面添加一个 number 信息为1
                          goodsInfo.number=1
                          cartList.push(goodsInfo)
                      }
            // 在存储到 localStorage 里面
            localStorage.setItem('cartList',JSON.stringify(cartList))
          
        }
 )</script></body></html>